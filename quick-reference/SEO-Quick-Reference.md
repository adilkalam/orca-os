# SEO Quick Reference (Internal)

**Updated:** 2025-11-07 (Phase 1-4 improvements live)

**Purpose:** Practical guide for running SEO automation with deep KG reading, external citations, and automated clarity gates.

**Public overview:** `docs/architecture/seo-orca.md`

---

## What Changed (Phase 1-4)

### Phase 1: Research Paper Index ✅
- External research at `/Users/adilkalam/Desktop/OBDN/obdn_site/docs/research/index.json`
- 7 papers indexed (retatrutide, tesamorelin, L-carnitine, MOTS-c)
- Auto-loaded by topic keywords for E-E-A-T citations

### Phase 2: Deep KG Reading ✅
- Pipeline reads FULL markdown source files (not 200-char excerpts)
- Module: `scripts/seo_kg_deep_reader.py`
- Relevance-scored section extraction (10-40KB per file)
- Automatic external citation loading

### Phase 3: Communication Heuristics ✅
- Draft writer uses v4 clarity principles
- Natural analogies ("three dials", "two bank accounts")
- Inline jargon explanation ("AMPK—the cell's energy sensor")
- "Gym buddy test" - can reader explain without lookup?

### Phase 4: Clarity Quality Gates ✅
- Script: `scripts/seo_clarity_gates.py`
- Jargon detection (50+ terms), analogy verification
- Clarity score 70+ required to pass
- Auto-run by Quality Guardian

**Expected Output:** 2,500-3,500 words, 70-80/100 score, matches manual v4 quality

---

## Modes

- ORCA (recommended, guided)
  - In Claude Code, invoke: `/seo-orca`
  - Provide:
    - Primary keyword (e.g., `Semax Selank ADHD`)
    - Curated research doc(s) (absolute paths)
    - Knowledge graph JSON (absolute path)
    - Knowledge root directory (for evidence file paths)
    - Focus terms (optional; entities/conditions)
  - ORCA will confirm the specialist team and run the pipeline with `--draft`.

- CLI (direct, fast)
  - Curated/KG only (cleanest, no SERP):
    ```bash
    python3 scripts/seo_auto_pipeline.py "<KEYWORD>" \
      --max-results 0 --allowlist-only --draft \
      --research-doc "/abs/path/to/curated1.md" \
      --research-doc "/abs/path/to/curated2.md" \
      --knowledge-graph "/abs/path/to/kg.json" \
      --knowledge-root "/abs/path/to/kg/root" \
      --focus-term Term1 --focus-term Term2
    ```
  - With SERP (still keyless):
    ```bash
    python3 scripts/seo_auto_pipeline.py "<KEYWORD>" \
      --max-results 6 --allowlist-only --draft \
      --research-doc "/abs/path/to/curated.md" \
      --knowledge-graph "/abs/path/to/kg.json" \
      --knowledge-root "/abs/path/to/kg/root"
    ```

---

## Outputs

Artifacts are written to `outputs/seo/` using a slug derived from the keyword:

- `<slug>-report.json` — research pack (articles analyzed, insights, KG, brief payload)
- `<slug>-brief.json` — structured brief (machine‑readable)
- `<slug>-brief.md` — brief for human review
- `<slug>-draft.md` — first‑pass draft (2,500-3,500 words, external citations, clarity-optimized)
- `<slug>-qa.md` — QA summary with clarity gate results (auto-generated by Quality Guardian)
- `<slug>-draft-clarity-report.json` — detailed clarity metrics (jargon, analogies, sentence length)

---

## Behavior (No API Keys)

- LLMs disabled: everything is heuristic. The draft generator builds meaningful H2/H3 sections using curated research and knowledge graph evidence.
- SERP optional: if `--max-results > 0`, the script uses a DuckDuckGo library or the `ddgs` CLI fallback (if available). Results are filtered:
  - Allowlist preference: .gov/.edu and known evidence domains (PubMed/PMC/NCBI/CDC/WHO/Cochrane, etc.)
  - Vendor/social downranking and hard‑block for some domains (e.g., TikTok)
  - `--allowlist-only` restricts to allowlisted/gov/edu only

---

## Recommended Inputs

- Curated research: well‑structured Markdown with clear headings and 2–3 sentence paragraphs per section.
- Knowledge graph: JSON with nodes/edges and evidence paths; pass `--knowledge-root` so the pipeline can resolve relative references and include excerpts.
- Focus terms: include synonyms/variants to improve matching (e.g., `GLP-1`, `GLP1`, `retatrutide`, `semaglutide`, `recomp`).

---

## Example (OBDN paths)

```bash
python3 scripts/seo_auto_pipeline.py "Semax Selank ADHD" \
  --max-results 0 --allowlist-only --draft \
  --research-doc "/Users/adilkalam/Desktop/OBDN/obdn_site/docs/semax-selank.md" \
  --knowledge-graph "/Users/adilkalam/Desktop/OBDN/obdn_site/docs/meta/kg.json" \
  --knowledge-root "/Users/adilkalam/Desktop/OBDN/obdn_site" \
  --focus-term Semax --focus-term Selank --focus-term ADHD --focus-term anxiety
```

---

## Draft Quality & What to Expect

### Automatic Features (Phase 1-4)
- **Deep content extraction:** Full source files read (10-40KB), not snippets
- **External citations:** Research papers auto-loaded with DOIs (NEJM, Nature Medicine, Cell Metabolism)
- **Natural analogies:** "Three dials", "two bank accounts" style explanations for complex concepts
- **Inline jargon:** Terms explained functionally ("AMPK—the cell's energy sensor that triggers fat breakdown")
- **Clarity scoring:** 70+ required to pass (jargon <10, analogies present, sentence length 15-20 words)

### What You Still Control
- **POV and voice:** Final tone adjustments
- **Compliance review:** Medical disclaimers, FDA language
- **Internal links:** Add peptide cards, protocols, axis pages
- **SEO metadata:** Fine-tune title tag, meta description
- **Publishing:** Schedule, social promos, distribution

### Tips for Best Results
- Include synonyms in `--focus-term` to improve section matching
- KG source files should have clear H2/H3 structure
- Research papers in `/docs/research/` auto-load by topic keywords
- Review clarity report JSON for specific improvement areas

---

## Manual Clarity Check (Optional)

Quality Guardian runs this automatically, but you can check any draft manually:

```bash
python3 scripts/seo_clarity_gates.py outputs/seo/<slug>-draft.md
```

**Output:**
- Console summary with pass/fail status
- Clarity score breakdown (sentence clarity, jargon management, analogy presence, paragraph readability)
- Specific recommendations
- JSON report: `<slug>-draft-clarity-report.json`

**Pass Criteria:**
- Clarity score: 70+
- Unexplained jargon: <10 instances
- Analogies: At least 1 natural analogy
- Sentence length: 15-20 words average

**Common Issues & Fixes:**
- `Score <70, jargon_management low` → Add inline explanations for technical terms
- `No analogies detected` → Add natural comparisons for complex concepts
- `Sentence clarity low` → Break long sentences (20+ words) into shorter ones
- `Paragraph readability low` → Split dense paragraphs into 2-3 sentence chunks

---

## Troubleshooting

- “DDGS not installed; skipping SERP” — Either install a Python library (ddgs/duckduckgo‑search) or rely on the built‑in `ddgs` CLI fallback or run with `--max-results 0`.
  - CLI fallback requires `ddgs` to be on PATH (pipx or brew). The script detects and uses it automatically.
- PEP 668 (externally managed env) — Avoid installing Python libs into system Homebrew Python; use pipx or a venv. Or run with `--max-results 0`.
- `trafilatura` optional — If not present, the pipeline uses a naive extractor. Install trafilatura for better article text extraction (optional).
- LLMs disabled — By design. To keep everything keyless, API usage was removed.

---

## ORCA Presets (Optional)

If you frequently reuse the same curated/KG paths, consider adding a small wrapper command (or a preset in `/seo-orca`) that fills those defaults so you only provide the keyword. Ask if you want this scaffolded.

